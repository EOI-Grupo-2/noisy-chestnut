<!DOCTYPE html>
<html lang="en" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/main_layout.html}"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search</title>
    <link rel="stylesheet" th:href="@{/css/search.css}">
</head>
<body>
<div class="content" layout:fragment="content">

    <!-- Buscador -->
    <form action="/search" method="get" class="search-form">
        <input type="text" name="query" placeholder="Buscar..." required>
        <select name="type">
            <option value="">Todos</option>
            <option value="user">Usuarios</option>
            <option value="concert">Conciertos</option>
            <option value="place">Lugares</option>
        </select>
        <button type="submit">Buscar</button>
    </form>

    <!-- Tabs menú -->
    <div class="tabs-menu">
        <button class="tabs-menu__item active" onclick="selectTab('usersTab')">Usuarios</button>
        <button class="tabs-menu__item" onclick="selectTab('concertsTab')">Conciertos</button>
        <button class="tabs-menu__item" onclick="selectTab('placesTab')">Lugares</button>
    </div>

    <!-- Usuarios -->
    <div class="search-content" id="usersTab">
        <div th:if="${users != null}">
            <div th:each="user : ${users}" class="user-card">
                <div class="user-card__info">
                    <img class="user-card__image" th:src="${user.imageUrl}" alt="Profile Image"/>
                    <h1 class="user-card__username">
                        <a class="user-card__link" th:href="@{/user/profile(id=${user.id})}" th:text="${user.username}"></a>
                    </h1>
                    <p class="user-card__description" th:text="${user.description}"></p>
                </div>
                <button class="user-card__button">Seguir</button>
            </div>
        </div>
        <p th:if="${#lists.isEmpty(users)}">No se encontraron usuarios.</p>
    </div>

    <!-- Conciertos -->
    <div class="search-content" id="concertsTab" style="display:none;">
        <div th:if="${concerts != null}">
            <div th:each="concert : ${concerts}" class="concert-card">
                <img class="concert-card__image" th:src="${concert.imageUrl}" alt="Concert Image"/>
                <div class="concert-card__content">
                    <h2 class="concert-card__title" th:text="${concert.name}"></h2>
                    <p class="concert-card__description" th:text="${concert.description}"></p>
                    <a th:href="@{/concert/detail(id=${concert.id})}" class="concert-card__link">Conocer más</a>
                </div>
            </div>
        </div>
        <p th:if="${#lists.isEmpty(concerts)}">No se encontraron conciertos.</p>
    </div>

    <!-- Lugares -->
    <div class="search-content" id="placesTab" style="display:none;">
        <div th:if="${places != null}">
            <div th:each="place : ${places}" class="place-card">
                <!-- Como PlaceDTO NO tiene imageUrl, mostramos una imagen por defecto -->
                <img class="place-card__image" th:src="@{/images/default_place.png}" alt="Place Image"/>
                <div class="place-card__content">
                    <h2 class="place-card__title" th:text="${place.name}"></h2>
                    <a th:href="@{/place/detail(id=${place.id})}" class="place-card__link">Conocer más</a>
                </div>
            </div>
        </div>
        <p th:if="${#lists.isEmpty(places)}">No se encontraron lugares.</p>
    </div>

</div>

<script>
    function selectTab(tabId) {
        const tabs = document.querySelectorAll('.search-content');
        tabs.forEach(tab => tab.style.display = 'none');
        document.getElementById(tabId).style.display = 'block';
    }
</script>
</body>
</html>
